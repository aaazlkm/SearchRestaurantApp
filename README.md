# 簡易仕様書サンプル

## ビルド手順

local.properties に以下のように API キーを入れてください。  
ここにキーを記載しないと、API通信の際にエラーになります。  

```local.properties
hotpepper_api_key=YOUR_HOTPEPPER_API_KEY
```

## 作者

新保太祥

## アプリ名

レストラン検索アプリ

## 対象 OS

Android: 12.0

## 開発環境/開発言語

Android Studio: Arctic Fox | 2020.3.1
Kotlin: 1.5.31

## 開発期間

2 週間

## 機能概要

- お店検索：ホットペッパーグルメサーチ API を使用して、現在地周辺のお店を検索する。
- お店詳細: ホットペッパーグルメサーチ API を使用して、お店の詳細情報を表示する。
- 地図アプリ連携：お店の所在地を地図アプリに連携する。
- Web アプリ連携: お店の Web ページを開く
- 共有機能： お店の URL 共有する。

## 画面概要

- 検索条件入力画面: お店を検索する際の条件を入力する
- 検索結果画面: 検索条件に基づいた結果をリスト形式で表示する
- 店舗詳細画面: お店の詳細情報を表示する

## 使用してるライブラリ、SDK など

- アーキテクチャ
  - MVI + Clean Architecture
  - (MVI は[DroidKaigi-2021](https://github.com/DroidKaigi/conference-app-2021)を参考)
- ライブラリ
  - kotlin
    - Stdlib
    - Coroutines
    - Coroutines Flow
    - Serialization
  - compose
  - dagger hilt
  - retrofit
  - gson
  - coil
  - timber
  - [...](https://github.com/aaazlkm/SearchRestaurantApp/blob/develop/gradle/common.gradle#L55-L101)
- API
  - ホットペッパーグルメサーチ API
- イラスト
  - [Loose Drawing](https://loosedrawing.com/)

## コンセプト

シンプルで使いやすいお店検索アプリ

## こだわったポイント

保守しやすいように設計にこだわって開発しました。  
このアプリでは MVI + Clean Architecture + DDD の考えを元に開発をしています。    
これにより、可読性が高く、重複がない、保守性のあるコードを書けていることを実感しています。    

## デザイン面でこだわったポイント

アプリの操作性にこだわった開発しました。    
具体的にやったこととしてはこちらです。  

**1 取得したデータをキャッシュすることで、余計な通信を減らし読み込みを早くした**

お店詳細画面の最初の実装としては、画面を開く時に毎回 API 通信をしてお店の情報を取得してました。   
この実装でも問題なく動きますが、以下の点で上手くないと感じていました。  

- すでに検索結果画面で情報を取得してるのに、再度 API 通信をしてる点
- お店詳細画面に遷移するたびに、ローディングが表示されてしまう点

この問題を解決するために、取得した情報をメモリにキャッシュし、お店詳細画面に遷移するときはキャッシュされたデータから読み込むようにしました。  
これによって余計な通信を抑えつつ画面の読み込みも速くなり、操作性が改善したと考えています. 

**2 細かい点までエラーハンドリングをして、エラーの原因と解決策を表示するようにした**

ただエラーであることを伝えるのではなく、具体的にどのようなエラーでそれを解決するために何をすればいいのか伝えるようにしました。  
例えば通信する際にAPIキーが含まれていなかったら、以下のように表示しています。  

(原因)  : APIキーまたはIPアドレスに問題があります  
(解決策): 開発者に問い合わせてください  

これにより、エラーになってもユーザが次に行うべき行動が明確になるので、操作性が改善したと考えています。  

**3 お店詳細画面でよく行う操作については、画面の上側にボタンとしてまとめた**

ユーザが詳細画面で行う操作としては、大きく以下の 3 つだと考えました。  

- より詳細のお店の情報を見る
- お店の場所を確認する
- 見つけたお店を人に共有する

これらの操作をしやすいように、画面の上側にそれぞれの操作に対応するボタンを表示しました。  
これによって、簡単にやりたいことが出来るようになったので、操作性が改善したと考えています。  

## アドバイスして欲しいポイント

Compose での状態管理についてアドバイスが欲しいです。  
現在の実装では、Compose での状態は全て外から引数で与えられるような実装になっています。  
この方法は、Android 公式でも[状態ホイスティング](https://developer.android.com/jetpack/compose/state?hl=ja#state-hoisting)として紹介されています。  
状態ホイスティングの方針で実装することにより、View を再利用したりテストが簡単になるなどのメリットがある一方で、保守性が低くなるデメリットも感じます。  
例えば状態ホイスティングの方針で実装を進めると、ある View の引数を変更した時、それより上の View 全てにその変更が影響してしまいます。  
これにより少し View に変更を入れるにも、多大な変更量が必要になる時があり、これは保守性を低くしてると感じます。  

今回のアプリの実装では[DroidKaigi-2021](https://github.com/DroidKaigi/conference-app-2021)を参考に実装していたので、画面の一番上から全ての状態を渡すようにしてますが、実際のプロジェクトではこの問題にどのように対処してるのかアドバイスを聞きたいです。  

## 自己評価

ただデータを取得し表示するのではなく、デザインやエラーハンドリングなど細かい点まで考慮しながら開発したので、使いやすいアプリになってると感じる。  
また、今回の開発で初めてコルーチンや Compose、MVi などの最新の技術に触れて、キャッチアップができてよかったです。  
一方で、新しい技術の学習に時間が取りすぎたせいでアプリの機能については最小限になってしまったことは反省点だと感じています。  
